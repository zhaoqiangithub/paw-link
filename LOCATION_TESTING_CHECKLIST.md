# 定位功能测试检查清单

## 📋 测试环境准备

### 开发环境
```bash
# 1. 确保项目已更新
git status

# 2. 清理缓存
npm run reset-project

# 3. 启动开发服务器
npm start
```

### 测试设备清单
- [ ] Android 真机 1（小米/华为）
- [ ] Android 真机 2（OPPO/vivo）
- [ ] iOS 真机（iPhone）
- [ ] Android 模拟器
- [ ] iOS 模拟器
- [ ] Web 浏览器（Chrome/Safari）

---

## 🧪 功能测试

### 测试 1：首页地图定位

#### 步骤
1. 打开应用，进入首页
2. 等待地图加载完成
3. 观察地图是否自动定位（只对 Native 平台）
4. 点击右下角定位按钮
5. 等待定位结果

#### 预期结果
- [ ] 地图正常加载（< 3 秒）
- [ ] Native 平台：自动获取用户位置（5-15 秒）
- [ ] 显示用户位置标记（蓝色，带脉冲动画）
- [ ] 显示详细地址信息
- [ ] 定位按钮状态正确（🔄 重试中 / 📍 定位）

#### 失败情况测试
- [ ] **权限被拒绝**：显示引导用户开启权限的提示
- [ ] **超时**：自动重试（最多3次），仍失败显示详细错误
- [ ] **网络错误**：显示错误提示，提供手动选择位置选项

---

### 测试 2：发布页面地图定位

#### 步骤
1. 点击首页右下角"+"按钮
2. 填写宠物信息（至少名称和描述）
3. 点击"选择位置"按钮
4. 等待位置选择页面加载
5. 观察地图是否自动定位
6. 点击定位按钮

#### 预期结果
- [ ] 地图正常加载（< 3 秒）
- [ ] 显示定位按钮（右下角）
- [ ] 点击后显示定位中状态（🔄）
- [ ] 定位成功后在地图上显示标记
- [ ] 底部显示位置信息（地址、坐标、精度）
- [ ] 点击"确认位置"返回发布页面

#### 失败情况测试
- [ ] **权限被拒绝**：显示引导开启权限弹窗
- [ ] **定位超时**：自动重试，失败后显示详细错误
- [ ] **无网络**：显示"无法获取详细地址"

---

### 测试 3：定位权限测试

#### Android 权限测试
1. **首次安装测试**
   - [ ] 首次打开应用，请求定位权限
   - [ ] 点击"允许"
   - [ ] 验证定位功能正常

2. **拒绝权限测试**
   - [ ] 点击"拒绝"
   - [ ] 进入首页，地图不自动定位
   - [ ] 点击定位按钮
   - [ ] 弹出引导开启权限的提示框
   - [ ] 点击"设置"跳转到应用权限页面
   - [ ] 手动开启权限
   - [ ] 返回应用，验证定位功能正常

3. **权限说明测试**
   - [ ] 检查权限提示文案清晰易懂
   - [ ] 提供详细的开启步骤

#### iOS 权限测试
1. **首次安装测试**
   - [ ] 首次打开应用，请求定位权限
   - [ ] 点击"允许在使用应用期间"
   - [ ] 验证定位功能正常

2. **拒绝权限测试**
   - [ ] 点击"不允许"
   - [ ] 进入首页，地图不自动定位
   - [ ] 点击定位按钮
   - [ ] 弹出引导开启权限的提示框
   - [ ] 点击"设置"跳转到设置页面
   - [ ] 手动开启权限
   - [ ] 返回应用，验证定位功能正常

---

### 测试 4：网络环境测试

#### WiFi 环境测试
- [ ] **正常 WiFi**：定位成功（5-10 秒）
- [ ] **信号弱 WiFi**：定位成功（10-15 秒）
- [ ] **WiFi 断网**：显示网络错误，提供手动选择位置

#### 4G/5G 环境测试
- [ ] **4G 网络**：定位成功（5-10 秒）
- [ ] **5G 网络**：定位成功（3-8 秒）
- [ ] **信号弱区域**：定位成功（10-20 秒）

#### 离线测试
- [ ] **无网络**：无法获取地址，但可以定位坐标
- [ ] **离线缓存**：如果之前访问过，显示缓存地址

---

### 测试 5：环境场景测试

#### 室外测试（GPS 信号强）
- [ ] **开阔地带**：定位成功，精度 < 50 米
- [ ] **建筑物附近**：定位成功，精度 < 100 米
- [ ] **地下停车场**：定位失败或精度 > 500 米

#### 室内测试（GPS 信号弱）
- [ ] **靠近窗户**：定位成功，精度 100-300 米
- [ ] **室内中央**：定位可能失败，显示错误
- [ ] **商场/地铁**：定位可能失败，需要手动选择

#### 移动中测试
- [ ] **步行**：定位跟随，精度 50-200 米
- [ ] **驾车**：定位跟随，精度 50-200 米
- [ ] **高速**：定位跟随，精度 100-500 米

---

### 测试 6：电量优化测试

#### 低电量模式测试
- [ ] **Android 低电量**：定位功能正常
- [ ] **iOS 低电量**：定位功能正常
- [ ] **省电策略**：定位时间可能延长

---

### 测试 7：边界情况测试

#### 极端环境测试
- [ ] **极冷环境**（< -10°C）：定位功能正常
- [ ] **极热环境**（> 40°C）：定位功能正常
- [ ] **高海拔**：定位功能正常

#### 数据边界测试
- [ ] **无效坐标**：处理无效坐标不崩溃
- [ ] **海外坐标**：处理海外坐标不崩溃
- [ ] **坐标转换**：WGS84 ↔ GCJ02 转换正确

---

### 测试 8：性能测试

#### 定位时间测试
- [ ] **首次定位**：< 15 秒
- [ ] **缓存定位**：< 3 秒
- [ ] **重试定位**：< 12 秒

#### 内存使用测试
- [ ] **首页**：内存使用 < 100MB
- [ ] **定位页面**：内存使用 < 120MB
- [ ] **长时间使用**：内存使用稳定，无泄漏

#### CPU 占用测试
- [ ] **定位过程中**：CPU 占用 < 30%
- [ ] **定位完成后**：CPU 占用 < 10%
- [ ] **地图交互**：流畅（60 FPS）

---

### 测试 9：兼容性测试

#### Android 版本兼容性
- [ ] **Android 8.0**：功能正常
- [ ] **Android 10.0**：功能正常
- [ ] **Android 12.0**：功能正常
- [ ] **Android 14.0**：功能正常

#### iOS 版本兼容性
- [ ] **iOS 14**：功能正常
- [ ] **iOS 15**：功能正常
- [ ] **iOS 16**：功能正常
- [ ] **iOS 17**：功能正常

#### 浏览器兼容性
- [ ] **Chrome**：功能正常
- [ ] **Safari**：功能正常
- [ ] **Edge**：功能正常
- [ ] **Firefox**：功能正常

---

### 测试 10：错误恢复测试

#### 错误类型测试
- [ ] **PERMISSION_DENIED**：显示权限引导
- [ ] **POSITION_UNAVAILABLE**：显示位置不可用错误
- [ ] **TIMEOUT**：自动重试，失败后显示超时错误
- [ ] **NETWORK_ERROR**：显示网络错误

#### 错误提示测试
- [ ] 错误信息清晰易懂
- [ ] 提供解决步骤
- [ ] 提供重试选项
- [ ] 提供手动选择位置选项

#### 自动恢复测试
- [ ] 网络恢复后定位功能正常
- [ ] 权限恢复后定位功能正常
- [ ] GPS 信号恢复后定位功能正常

---

## 📊 测试结果记录

### 记录模板

```
测试时间：____年__月__日 __:__
测试设备：________________
系统版本：________________
应用版本：v1.1.0

测试项：
□ 首页地图定位
□ 发布页面定位
□ 权限测试
□ 网络环境测试
□ 环境场景测试
□ 性能测试
□ 兼容性测试
□ 错误恢复测试

结果汇总：
✅ 通过：__ 项
❌ 失败：__ 项
⚠️ 问题：__ 项

问题详情：
1. ________________________________
2. ________________________________
3. ________________________________

建议改进：
1. ________________________________
2. ________________________________
3. ________________________________
```

---

## 🚨 常见问题及解决方案

### 问题 1：定位按钮无响应

**可能原因**
- 地图未加载完成
- 定位功能被禁用

**解决方案**
- 等待地图加载完成（看到地图视图）
- 重启应用

### 问题 2：定位一直显示"🔄"状态

**可能原因**
- 权限被拒绝
- GPS 信号弱
- 网络异常

**解决方案**
- 检查定位权限
- 移动到开阔地带
- 检查网络连接
- 重启应用

### 问题 3：地址显示"无法获取详细地址"

**可能原因**
- 网络异常
- 坐标超出中国范围

**解决方案**
- 检查网络连接
- 移动到中国大陆区域

---

## ✅ 测试完成标准

### 必须通过的测试
- [ ] 首页地图定位（安卓真机）
- [ ] 发布页面定位（安卓真机）
- [ ] 权限拒绝处理（安卓真机）
- [ ] 错误提示显示（安卓真机）

### 建议通过的测试
- [ ] 网络环境测试（WiFi/4G）
- [ ] 室内外场景测试
- [ ] 性能测试
- [ ] 兼容性测试

### 可选测试
- [ ] 极端环境测试
- [ ] 边界情况测试
- [ ] 长时间使用测试

---

## 📞 提交测试报告

测试完成后，请将测试结果提交到：

**文件名**：`LOCATION_TEST_REPORT_[设备型号]_[日期].md`

**内容要求**：
1. 测试环境信息
2. 测试结果汇总
3. 发现的问题及截图
4. 改进建议

**示例**：
```markdown
# 定位功能测试报告

## 测试环境
- 设备：小米 13 Pro
- 系统：Android 14
- 应用版本：v1.1.0
- 测试时间：2025-11-20 14:30

## 测试结果
- 通过：15 项
- 失败：0 项
- 问题：0 项

## 结论
✅ 测试通过，定位功能正常。
```
